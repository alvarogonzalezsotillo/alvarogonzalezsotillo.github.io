<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-05-16 mar 15:27 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bittorrent en el aula</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="alvaro" />
<meta name="description" content="BitTorrent es un protocolo p2p para el intercambio de ficheros. Se suele asociar a descargas ilegales, pero puede ser muy útil en el aula de informática."
 />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Bittorrent en el aula</h1>
<p style="float:left;">
<img src="utorrent-small.jpg" alt="utorrent-small.jpg" style="float:left;" />
Durante el desarrollo de ciclos formativos de grado medio y superior, es muy común la necesidad de compartir ficheros con los alumnos. Para ilustrar el problema, supondremos que el profesor necesita distribuir una ISO de instalación de Ubuntu (1.6 GBytes) en un aula con 15 ordenadores.
</p>

<div id="outline-container-org783eab2" class="outline-2">
<h2 id="org783eab2">Solución 1: Uso de <i>pen drive</i></h2>
<div class="outline-text-2" id="text-org783eab2">
<p style="float:right;">
<img src="pendrive-small.jpg" alt="pendrive-small.jpg" style="float:right;" />
El profesor pasa por cada puesto de alumno, copiando desde un disco duro externo o <i>pen drive</i> el fichero deseado. Suponiendo una  tasa de transferencia de 25 MBytes/segundo, cada alumno necesita unos 60 segundos para conseguir su copia. Incluyendo el proceso de conexión y desconexión cada alumno necesita unos 2 minutos. Esto hace un total de 30 minutos para distribuir el fichero.
</p>
</div>
</div>

<div id="outline-container-orgd10e54d" class="outline-2">
<h2 id="orgd10e54d">Solución 2: Uso de pen drive y copias de alumnos</h2>
<div class="outline-text-2" id="text-orgd10e54d">
<p>
Si cada alumno que consigue el fichero lo  copia a un pen drive propio y lo distribuye a otros alumnos, puede copiarse el fichero mucho más rápido. Esta es una posibilidad teórica más que real, puesto que los alumnos no suelen entender el proceso y se tarda más en explicarlo que en aplicar la primera solución.
</p>
</div>
</div>

<div id="outline-container-orge1a2239" class="outline-2">
<h2 id="orge1a2239">Solución 3: Uso de un servidor de ficheros</h2>
<div class="outline-text-2" id="text-orge1a2239">
<p style="float:right;">
<img src="sharedfolder-small.jpg" alt="sharedfolder-small.jpg" style="float:right;" />
El fichero puede hacerse accesible desde la red, y cada alumno baja su propia copia. Este enfoque tiene algunas particularidades:
</p>

<ul class="org-ul">
<li>En una red a 100 MB (con una tasa efectiva de 10 MBytes/s) la transferencia a un solo alumno tardaría unos dos minutos. El problema es que el servidor debe compartir su enlace entre todos los alumnos, por lo que el tiempo total empleado sería de 30 minutos</li>
<li>En una red a 1 GB solo se necesitarían 3 minutos. Desgraciadamente, las aulas no suelen tener switches de estas velocidades</li>
<li>Si se utiliza un servidor web en vez de un servidor de ficheros, las transferencias suelen comprimirse. En este caso, los tiempos pueden bajar a la mitad, e incluso menos (HTTP suele ser más eficiente que CIFS).</li>
</ul>
</div>
</div>

<div id="outline-container-orgdbfe292" class="outline-2">
<h2 id="orgdbfe292">Solución 4: Uso de un protocolo de red p2p</h2>
<div class="outline-text-2" id="text-orgdbfe292">
<p style="float:right;">
<img src="utorrent-small.jpg" alt="utorrent-small.jpg" style="float:right;" />
El problema fundamental del servidor de ficheros es que una sola conexión debe dar servicio a todos los alumnos. Si conseguimos que cada alumno comparta su conexión con los demás, este cuello de botella queda resuelto. De esta forma, se consigue una transferencia casi simultánea a todos los alumnos del fichero, necesitando solo 3 minutos para una red a 100 MB.
</p>

<p>
Estos <a href="http://en.wikipedia.org/wiki/Back-of-the-envelope_calculation">cálculos de servilleta</a> muestran que el uso de <a href="http://en.wikipedia.org/wiki/BitTorrent">BitTorrent</a> puede ser muy interesante para repartir estos grandes ficheros en el aula. En <a href="http://www.rarst.net/software/torrent-deploy-files/">rarst.net</a> se dan unas instrucciones muy completas, que yo he adaptado a mis aulas.  El resultado final es que, con la simple ejecución de un fichero BAT desde el puesto del profesor, ficheros de gran tamaño se distribuyen a todo el aula sin intervención de los alumnos :
</p>
<ol class="org-ol">
<li>Copiar el fichero en una carpeta compartida (preferiblemente, de un servidor de aula). De esta forma, el fichero puede ser accedido "manualmente" con posterioridad.</li>
<li>Instalar de <a href="http://www.utorrent.com/">μTorrent</a> en el ordenador del profesor. Anotar el puerto utilizado para el protocolo BitTorrent (por ejemplo, 21212)</li>
<li>Activar el tracker en el ordenador del profesor incluido en μTorrent:  Options &gt; Preferences &gt; Advanced &gt; bt.enable_tracker &gt; set true</li>
<li>Crear un torrent con  μTorrent  desde el ordenador del profesor con los ficheros deseados. Los ficheros se pueden especificar con la ruta UNC, o utilizar una copia local. El tracker a utilizar será  <a href="http://hostname%3Aport/announce">http://hostname:port/announce</a> , cambiando hostnamepor la IP del ordenador del profesor, y port por el puerto usado en el punto 2.</li>
</ol>


<div class="figure">
<p><img src="crear-torrent.png" alt="crear-torrent.png" />
</p>
</div>

<p>
El fichero torrent se grabará en la carpeta compartida junto al fichero a distribuir y el programa  μTorrent.exe
</p>


<div class="figure">
<p><img src="listado-ficheros.png" alt="listado-ficheros.png" />
</p>
</div>


<p>
Utilizar <code>psexec</code> para ejecutar de forma remota  μTorrent en todos los ordenadores de los alumnos, por ejemplo con un fichero BAT. Utilizo <code>start /b</code> para que el proceso se haga en forma paralela, sin tener que esperar a un ordenador para lanzar la orden en el siguiente:
</p>



<div class="org-src-container">
<label class="org-src-name"><span class="listing-number">Listing 1: </span>distribuir-ubuntu-12.04.1-desktop-i386.iso.bat</label><pre class="src src-bat"><span style="color: #b0c4de;">set</span> <span style="color: #eedd82;">SLEEP</span>=ping 192.0.2.2 -<span style="color: #98fb98;">n</span> 1 -<span style="color: #98fb98;">w</span> 10000 


<span style="color: #b0c4de;">set</span> <span style="color: #eedd82;">DIRECTORIO</span>=f:\isos 
<span style="color: #b0c4de;">set</span> <span style="color: #eedd82;">FICHEROTORRENT</span>=%~dp0\ubuntu-12.04.1-desktop-i386.iso.torrent 
<span style="color: #b0c4de;">set</span> <span style="color: #eedd82;">FICHEROIPDEALUMNOS</span>=%~dp0\IPS_ALUMNOS_a223.txt 


<span style="color: #cd853f;">REM SE MATAN LOS UTORRENT DE EJECUCIONES ANTERIORES</span>
<span style="color: #00ffff;">for</span> /<span style="color: #98fb98;">f</span> %%<span style="color: #eedd82;">i</span> <span style="color: #00ffff;">in</span> <span style="color: #8c8c8c;">(</span> '<span style="color: #b0c4de;">type</span> %<span style="color: #eedd82;">FICHEROIPDEALUMNOS</span>%' <span style="color: #8c8c8c;">)</span> <span style="color: #00ffff;">do</span> <span style="color: #00ffff;">start</span> /<span style="color: #98fb98;">b</span> psexec \\%%<span style="color: #eedd82;">i</span> -<span style="color: #98fb98;">d</span> -<span style="color: #98fb98;">s</span> <span style="color: #00ffff;">cmd</span> /<span style="color: #98fb98;">c</span> taskkill /<span style="color: #98fb98;">IM</span> utorrent.exe /<span style="color: #98fb98;">F</span>

%<span style="color: #eedd82;">SLEEP</span>%

<span style="color: #cd853f;">REM SE CREA EL DIRECTORIO</span>
<span style="color: #00ffff;">for</span> /<span style="color: #98fb98;">f</span> %%<span style="color: #eedd82;">i</span> <span style="color: #00ffff;">in</span> <span style="color: #8c8c8c;">(</span> '<span style="color: #b0c4de;">type</span> %<span style="color: #eedd82;">FICHEROIPDEALUMNOS</span>%' <span style="color: #8c8c8c;">)</span> <span style="color: #00ffff;">do</span> <span style="color: #00ffff;">start</span> /<span style="color: #98fb98;">b</span> psexec \\%%<span style="color: #eedd82;">i</span> -<span style="color: #98fb98;">d</span> <span style="color: #00ffff;">cmd</span> /<span style="color: #98fb98;">c</span> <span style="color: #b0c4de;">mkdir</span> %<span style="color: #eedd82;">DIRECTORIO</span>%


%<span style="color: #eedd82;">SLEEP</span>%

<span style="color: #cd853f;">REM SE EJECUTA EL TORRENT</span>
<span style="color: #00ffff;">for</span> /<span style="color: #98fb98;">f</span> %%<span style="color: #eedd82;">i</span> <span style="color: #00ffff;">in</span> <span style="color: #8c8c8c;">(</span> '<span style="color: #b0c4de;">type</span> %<span style="color: #eedd82;">FICHEROIPDEALUMNOS</span>%' <span style="color: #8c8c8c;">)</span> <span style="color: #00ffff;">do</span> <span style="color: #00ffff;">start</span> /<span style="color: #98fb98;">b</span> psexec \\%%<span style="color: #eedd82;">i</span> -<span style="color: #98fb98;">c</span> -<span style="color: #98fb98;">v</span> -<span style="color: #98fb98;">d</span> -<span style="color: #98fb98;">s</span> -<span style="color: #98fb98;">i</span> %~dp0\utorrent.exe /<span style="color: #98fb98;">NOINSTALL</span> /<span style="color: #98fb98;">HIDE</span> /<span style="color: #98fb98;">DIRECTORY</span> %<span style="color: #eedd82;">DIRECTORIO</span>% %<span style="color: #eedd82;">FICHEROTORRENT</span>%
</pre>
</div>

<p>
Y por último, comprobar que está funcionand o. El fichero "aparecerá" en los ordenadores del aula en pocos minutos ☺
</p>

<p>
Posibles problemas con <code>PsExec</code>
</p>
<ul class="org-ul">
<li>En algunos sistemas, no es posible arrancar un servicio que interactue simultáneamente con la red y el entorno gráfico. Puesto que <code>PsExec</code> arranca <code>utorrent.exe</code> como un servicio, a veces será necesario arrancarlo sin el parámetro <code>-i</code></li>
<li>En algunos sistemas, la cuenta <code>SYSTEM</code> puede no tener permisos para acceder a una unidad compartida. En ese caso pueden usarse los parámetros <code>-u</code> y <code>-p</code> para especificar un usuario y una contraseña.</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2017-05-16 mar</p>
<p class="author">Author: alvaro</p>
<p class="date">Created: 2017-05-16 mar 15:27</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
